// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at https://mozilla.org/MPL/2.0/.

@use 'sass:color';
@use 'functions';
@use 'variables';
@use 'tokens/sys/themes/light';
@use 'tokens/sys/themes/dark';
@use 'tokens/sys/shape';
@use 'tokens/sys/typescale';
@use 'tokens/sys/motion';

$classname: textfield !default;

// filled variabled
$filled-container-height: 3.5rem;
$filled-top-bottom-padding: 0.5rem;
$filled-left-right-padding-without-icon: 1rem;
$filled-left-right-padding-with-icon: 0.75rem;
$filled-supporting-text-top-padding: 0.25rem;

// outlined variabled
$outlined-container-height: 3.5rem;
$outlined-top-bottom-padding: 0.5rem;
$outlined-left-right-padding-without-icon: 1rem;
$outlined-left-right-padding-with-icon: 0.75rem;
$outlined-supporting-text-top-padding: 0.25rem;

.#{$classname} {
  &-filled {
    & *, *::before, *::after {
      box-sizing: border-box;
    }

    & > .#{$classname}-container {
      align-items: center;
      background: light.$md-sys-color-surface-variant;
      border-radius: shape.$md-sys-shape-corner-extra-small-top;
      display: flex;
      height: $filled-container-height;
      padding-bottom: $filled-top-bottom-padding;
      padding-top: $filled-top-bottom-padding;
      position: relative;
  
      &:focus-within::after {
        border-bottom-width: 0.125rem;
        border-bottom-color: #6750a4;
        transition-duration: motion.$md-sys-motion-transition-duration;
        transition-property: border-color, border-width;
        transition-timing-function: motion.$md-sys-motion-easing-standard-curve;
      }

      // represents the 'Active indicator' (the bottom line that changes color and increased its size when focussed)
      &::after {
        border-bottom: 0.0625rem solid light.$md-sys-color-on-surface-variant;
        bottom: 0;
        content: ' ';
        left: 0;
        pointer-events: none;
        position: absolute;
        user-select: none;
        width: 100%;
      }
  
      & > .#{$classname}-leading-icon {
        color: light.$md-sys-color-on-surface-variant;
        font-size: 1.25em;
        line-height: 0;
        margin-left: $filled-left-right-padding-with-icon;
        padding-left: 0.125rem;
        padding-right: 0.125rem;
        pointer-events: none;
        user-select: none;

        & ~ .#{$classname}-label {
          left: 3.25rem;
        }
      }
      
      & > .#{$classname}-input {
        align-self: end;
        background: none;
        border-width: 0;
        caret-color: light.$md-sys-color-primary;
        color: light.$md-sys-color-on-surface;
        font-family: typescale.$md-sys-typescale-body-large-font;
        font-size: typescale.$md-sys-typescale-body-large-size;
        font-weight: typescale.$md-sys-typescale-body-large-weight;
        letter-spacing: typescale.$md-sys-typescale-body-large-tracking;
        line-height: typescale.$md-sys-typescale-body-large-line-height;
        margin-left: $filled-left-right-padding-without-icon;
        margin-right: $filled-left-right-padding-without-icon;
        padding: 0;
        width: 100%;
    
        &:focus {
          outline: none;
          & ~ .#{$classname}-label {
            color: light.$md-sys-color-primary;
         }
        }
    
        // the input is empty and not focused
        &:placeholder-shown:not(:focus) ~ .#{$classname}-label {
          font-size: typescale.$md-sys-typescale-body-large-size;
          line-height: typescale.$md-sys-typescale-body-large-line-height;
          top: 1rem;
        }
      }
    
      // by default the label is styled in 'populated mode' so that browsers not supporting 'advanced' css are ok
      & > .#{$classname}-label {
        color: light.$md-sys-color-on-surface-variant;
        font-family: typescale.$md-sys-typescale-body-large-font;
        font-size: typescale.$md-sys-typescale-body-small-size;
        font-weight: typescale.$md-sys-typescale-body-large-weight;
        left: $filled-left-right-padding-without-icon;
        letter-spacing: typescale.$md-sys-typescale-body-large-tracking;
        line-height: typescale.$md-sys-typescale-body-small-line-height;
        margin-right: $filled-left-right-padding-without-icon;
        pointer-events: none;
        position: absolute;
        top: $filled-top-bottom-padding;
        transition-duration: motion.$md-sys-motion-transition-duration;
        transition-property: color, transform, top, font-size, line-height, left, padding;
        transition-timing-function: motion.$md-sys-motion-easing-standard-curve;
        user-select: none;
      }
    
      & > .#{$classname}-trailing-icon {
        color: light.$md-sys-color-on-surface-variant;
        font-size: 1.5rem;
        line-height: 0;
        margin-right: $filled-left-right-padding-with-icon;
        pointer-events: none;
        transition-duration: motion.$md-sys-motion-transition-duration;
        transition-property: color;
        transition-timing-function: motion.$md-sys-motion-easing-standard-curve;
        user-select: none;
      }    
    }
    & > .#{$classname}-supporting-text {
      color: light.$md-sys-color-on-surface-variant;
      display: block;
      font-family: typescale.$md-sys-typescale-body-small-font;
      font-size: typescale.$md-sys-typescale-body-small-size;
      font-weight: typescale.$md-sys-typescale-body-small-weight;
      line-height: typescale.$md-sys-typescale-body-small-line-height;
      margin-left: $filled-left-right-padding-without-icon;
      margin-top: $filled-supporting-text-top-padding;
      letter-spacing: typescale.$md-sys-typescale-body-small-tracking;
    }
  }
}
